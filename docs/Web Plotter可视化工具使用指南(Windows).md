# Web Plotter 可视化工具使用指南（Windows）

机器人的各种数据信息都是在ros的话题上获取的，在ubuntu上可直接通过plotjuggler获取，但是在windows上不能直接获取，通过终端连接直接使用指令来echo读取可以查看数据，但是没有plotjuggler的曲线查看，难以察觉变化规律，同时操作较为复杂。

本工具开启后会将数据上传至本地的服务器，在windows上输入网址即可查看，且支持曲线观察，在前端页面可以傻瓜式图形化操作。



## 1. 连接机器人电脑

在windows系统上，使用话题读取工具Web Plotter之前，要保证你的电脑能连接上机器人的小电脑

先让你的电脑的网络与小电脑处于同一局域网下，先打开你的控制面板

![1](Assert\1.png)

点击网络与Internel相关，选择“更改适配器选项”，就可以查看到你的网络连接情况了。

然后用网线（+拓展坞）连接小电脑，观察网络变化，多出来的那一栏就是你的电脑和小电脑的网络连接，此处为以太网 7

![2](Assert\2.png)



![3](Assert\3.png)

进入并查看属性，选择IPv4的设置，将IP从自动改为手动，设置为192.168.100.1,子网掩码为255.255.255.0，然后一直点确定保存，大概就连上了

<img src="Assert\4.png" alt="4" style="zoom:50%;" />



<img src="Assert\5.png" alt="5" style="zoom:50%;" />



完成设置后，使用win键+R的快捷键打开运行，输入cmd，开启cmd窗口

<img src="Assert\6.png" alt="6" style="zoom:50%;" />

在cmd窗口输入ping 192.168.100.2观察是否能连接，若有信息返回，则成功连接。

<img src="Assert\8.png" alt="8" style="zoom:50%;" />

接下来去浏览器上下载MobaXterm软件，进行ssh连接，用于验证是否连接机器人以及开启话题信息读取工具

MobaXterm下载地址：https://mobaxterm.mobatek.net/?spm=a2c6h.12873639.article-detail.7.6b502deaeMGAou



------



## 2. 启动可视化服务

这个程序不是开机自启的（开着会一定程度影响性能），需要连接上小电脑后手动开启

在 Windows 上通过 MobaXterm（或其它 SSH 工具）连接到小电脑终端后，请按照以下步骤启动后端服务。

**ssh连接**

先实现与小电脑的连接，打开MobaXterm，点击主页的左上角“session”按钮新建

![9](Assert\9.png)

在接下来的窗口按如下图进行设置，，点击左上角的SSH，Remote host为必填，必须为192.168.100.2，Specify username为选填，也就是每次连接的用户名，连接到小电脑是需要输入用户名和密码的，在这里先填好的话后面就不需要多输入一遍了（队内机器人小电脑的用户名和密码都统一为dynamicx），其他的保持默认即可

![10](Assert\10.png)

完成设置后点击OK，如果前面cmd内能ping上的话，基本就能连上，如下图所示，目前显示了输入密码的提示，输入密码dynamicx，再输入enter键即可访问**（由于linux系统的特性，输入密码的过程中你是看不见密码的，也就是说你要默写密码，然后按enter）**，同时也能注意到左侧出现了连接的选项，完成一次连接后软件会把连接的记录保存，同样的连接在下次直接双击该记录即可。

![11](Assert\11.png)

完成输入后，此时还会弹出询问是否保存密码的选项，这个非必要，根据自己需要来配置（少部分情况下会崩溃）

<img src="Assert\12.png" alt="12" style="zoom:50%;" />

左侧如果弹出大量文件，就说明访问成功

dynamicx@dart就是本电脑（这是飞镖的小电脑，不同兵种用户名不一样）

![13](Assert\13.png)



**启动后端Web Plotter程序**

在进入的终端窗口，执行以下命令后按enter键，启动 Web Plotter 后端：

**rosrun web_plotter_backend server.py**

当终端显示以下信息时，说明服务已成功启动：

![14](Assert\14.png)



若没有成功启动，可能ros机器人的程序并没有跑起来（不同兵种的机器人的情况可能不同，具体问对应的控制），比如根本没找到ROS master地址，就会报错如下：

![14-2](Assert\14-2.png)



如果是ROS核心没有启动，新开一个终端窗口，输入以下指令（如果已经启动了就会报错并无效化）：

**roscore**



后面读完了数据，不需要的话就把这个程序关了，直接把运行Web Plotter的终端关掉即可

<img src="Assert\19.png" alt="19" style="zoom:50%;" />



另外，如果在连接途中出现了下图的情况，即说明根本没连上小电脑，请回到**连接机器人电脑**部分检查

<img src="Assert\20.png" alt="20" style="zoom: 50%;" />

------



## 3. 访问前端页面

在 Windows 电脑，随便打开一个能输地址的浏览器（推荐 Google Chrome）。

1. **输入地址**：在地址栏输入 http://192.168.100.2:5000 （一般情况输入框默认会有）

   *注：如果修改过 IP，请以实际 IP 为准。*

2. **检查网络环境**：

   **确认连接**：页面加载后，左上角输入框应默认显示 IP 地址。点击 **“连接”** 按钮，如果有反应即连接成功。

   
   
   点击话题选项，正常情况下应该能显示目前正在运行的所有话题
   
   **（注意不要随便读取话题，有一些话题读了是会直接报错甚至崩掉的，比如视觉的一些图像话题是不能以曲线形式绘制的）**
   
   ![15](Assert\15.png)

------



## 4. 前端页面使用指南

### 4.1 基础操作

- **连接/断开**：点击左上角的“连接后端”按钮。连接成功后，下拉菜单会自动加载当前 ROS 系统中所有活跃的话题，以20hz的频率更新图像曲线和数据。

- **添加话题**：
  1. 在下拉菜单中选择您想观测的话题（例如/joint_states）。
  
  2. 点击右侧的 **“＋ 添加”** 按钮。
  
  3. 左侧列表会出现该话题的卡片。**支持添加多个话题同时监测**。
  
     ![16](Assert\16.png)

### 4.2 数据查看与绘图

- **查看数值**：
  - 点击左侧列表中的箭头展开层级。
  - **按住 Shift 键**并将鼠标悬停在任意数据节点上，可查看当前的实时数值预览。
- **绘制曲线**：
  - 点击任意 **数字类型**（int/float）或 **布尔类型**（bool）的叶子节点，右侧图表即刻开始绘制曲线。
  - **多线对比**：您可以点击多个不同的节点，它们会以不同颜色绘制在同一张图表上。
- **移除曲线**：
  - 再次点击左侧已选中的节点（高亮状态），或点击右下角图例旁的 **“×”** 号即可移除。

### 4.3 图表交互

- **暂停/继续**：
  - 点击右上角的 **“暂停”** 按钮。暂停后图表停止滚动，但**后台依然在记录数据**，不会丢失。
- **缩放与查看**：
  - **滚轮缩放**：在图表区域滚动鼠标滚轮，可放大/缩小时间轴。
  - **拖拽平移**：按住鼠标左键拖拽，查看历史数据。
  - **一键还原**：点击 **“ 还原”** 按钮，图表会自动跳回最新数据并恢复自动滚动。





------

## 5. 故障排查

在使用过程中若遇到问题，请对照下表查看终端报错或页面提示。**（仅供参考）**



### A. SSH 终端报错

| **报错信息**                                           | **原因分析**                                 | **解决方法**                                                 |
| ------------------------------------------------------ | -------------------------------------------- | ------------------------------------------------------------ |
| `Address already in use`                               | 端口 5000 被占用，通常是上次运行未正常关闭。 | 1. 输入 `fuser -k 5000/tcp` 强制杀死旧进程。 2. 重新运行 `rosrun` 命令。 |
| `ModuleNotFoundError: No module named 'flask'`         | 缺少 Python 依赖库。                         | 在小电脑执行安装命令（需联网）： `pip3 install flask flask-socketio eventlet` |
| `Unable to register with master node`                  | 找不到 `roscore`。                           | 请先在另一个终端运行 `roscore`，再运行本程序。               |
| `ImportError: No module named rospy_message_converter` | 缺少消息转换功能包。                         | 确认工作空间内是否用于 `rospy_message_converter`，或检查工作空间是否已编译 (`catkin build`) 并 source。 |



### B. 前端页面报错或异常

| **现象**                       | **原因分析**                                                 | **解决方法**                                                 |
| ------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **浏览器显示“无法访问此网站”** | 1. IP 地址输错。 2. 电脑开了 VPN。 3. 终端里的 server.py 没跑起来。 | 1. 检查 IP 是否为 192.168.100.2:5000。 2. **关闭 VPN/代理**。 3. 确认终端里显示 "Running on port 5000"。 |
| **点击“连接”后无反应**         | 前端连不上 WebSocket。                                       | 检查浏览器控制台 (F12)。                                     |
| **左侧显示“等待数据...”**      | 话题虽然已订阅，但 ROS 里没有该话题的数据发送。              | 在终端输入 rostopic hz <话题名>检查是否有数据发出。          |
| **曲线是断开的**               | 这是正常现象（断点检测特性）。                               | 若数据中断超过 0.5秒（如程序重启或丢包），曲线会自动断开以提示您数据不连续。 |